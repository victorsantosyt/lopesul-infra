(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6531],{166:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>u});var a=l(5155),r=l(2115),n=l(6278);let s=l.n(n)()(()=>l.e(4629).then(l.bind(l,4629)),{loadableGenerated:{webpack:()=>[require.resolveWeak("echarts-for-react")]},ssr:!1});function o(e){let{option:t,height:l=320,className:r}=e;return(0,a.jsx)(s,{option:t,notMerge:!0,lazyUpdate:!0,style:{height:l,width:"100%"},className:r})}function i(e){return(null!=e?e:0).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}function d(e){return new Date(e).toISOString().slice(0,10)}function u(){var e,t,l,n,s,u,c,x,p,m,b,g,h,y,f,v,j,w,N,S,k,_,P;let[O,L]=(0,r.useState)("30"),[A,M]=(0,r.useState)(!0),[E,D]=(0,r.useState)(null),C=(0,r.useMemo)(()=>new Date,[]),R=(0,r.useMemo)(()=>(function(e,t){let l=new Date(e);return l.setDate(l.getDate()+t),l})(C,-Number(O||30)),[C,O]);(0,r.useEffect)(()=>{let e=!1;return(async()=>{try{M(!0);let t="/api/relatorios?from=".concat(d(R),"&to=").concat(d(C)),l=await fetch(t,{cache:"no-store"}),a=await l.json();e||D(a)}catch(e){console.error(e)}finally{e||M(!1)}})(),()=>{e=!0}},[R,C]);let F=document.documentElement.classList.contains("dark"),T=F?"#a3aed0":"#475569",V=F?"#334155":"#e5e7eb",B=F?"#e2e8f0":"#0f172a",I=null!=(m=null==E||null==(e=E.series)?void 0:e.vendasPorDia)?m:[],G=null!=(b=null==E||null==(t=E.series)?void 0:t.pagosPorDia)?b:[],W=null!=(g=null==E?void 0:E.faturamentoPorFrota)?g:[],q=I.map(e=>e.date),z=I.map(e=>{var t;return null!=(t=e.total)?t:0}),U=G.map(e=>e.date),X=G.map(e=>{var t;return null!=(t=e.count)?t:0}),H=W.map(e=>{var t;return null!=(t=e.nome)?t:"Frota"}),J=W.map(e=>{var t;return Math.round(null!=(t=e.total)?t:0)}),K={grid:{left:40,right:20,top:30,bottom:35},tooltip:{trigger:"axis"},xAxis:{type:"category",boundaryGap:!1,axisLabel:{color:T},axisLine:{lineStyle:{color:V}},data:[]},yAxis:{type:"value",axisLabel:{color:T},axisLine:{lineStyle:{color:V}},splitLine:{show:!0,lineStyle:{color:V,type:"dashed"}}},textStyle:{color:T}},Q={...K,xAxis:{...K.xAxis,data:q},series:[{name:"Vendas",type:"line",smooth:!0,showSymbol:!1,areaStyle:{opacity:.08},lineStyle:{width:2},data:z}]},Y={...K,xAxis:{...K.xAxis,data:U},series:[{name:"Pagos",type:"line",smooth:!0,showSymbol:!1,areaStyle:{opacity:.08},lineStyle:{width:2},data:X}]},Z={grid:{left:40,right:20,top:30,bottom:40},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},valueFormatter:e=>i(e)},xAxis:{type:"category",axisLabel:{color:T,rotate:30*!!H.some(e=>{var t;return(null!=(t=null==e?void 0:e.length)?t:0)>12})},axisLine:{lineStyle:{color:V}},data:H},yAxis:{type:"value",axisLabel:{color:T},axisLine:{lineStyle:{color:V}},splitLine:{show:!0,lineStyle:{color:V,type:"dashed"}}},textStyle:{color:T},series:[{type:"bar",data:J,barWidth:28,itemStyle:{borderRadius:[8,8,0,0]}}]},$=null!=(h=null==E?void 0:E.resumo)?h:{totalVendas:0,receita:0,mediaTempoAcesso:"0 min",pagamentos:{pagos:0,pendentes:0,expirados:0}};return(0,a.jsxs)("div",{className:"p-6 md:p-8 bg-transparent min-h-screen transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 dark:text-white",children:"Relat\xf3rios e An\xe1lises"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Per\xedodo: ",d(R)," → ",d(C)]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("select",{value:O,onChange:e=>L(e.target.value),className:"px-3 py-2 rounded-md border border-gray-300 dark:border-gray-700 bg-white dark:bg-[#1e293b] text-gray-800 dark:text-gray-100",children:[(0,a.jsx)("option",{value:"7",children:"\xdaltimos 7 dias"}),(0,a.jsx)("option",{value:"30",children:"\xdaltimos 30 dias"}),(0,a.jsx)("option",{value:"90",children:"\xdaltimos 90 dias"})]}),(0,a.jsx)("button",{onClick:()=>window.print(),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md",children:"Exportar PDF"})]})]}),(0,a.jsxs)("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:" rounded-xl p-4 shadow border bg-yellow-50 border-yellow-200 text-yellow-900 dark:bg-yellow-500/10 dark:border-yellow-700 dark:text-yellow-200 ",children:[(0,a.jsx)("div",{className:"text-sm opacity-90",children:"Vendas (total)"}),(0,a.jsx)("div",{className:"mt-1 text-2xl font-bold",children:i(null!=(y=$.totalVendas)?y:0)}),(0,a.jsxs)("div",{className:"text-xs opacity-80",children:[null!=(f=$.qtdVendas)?f:0," opera\xe7\xf5es"]})]}),(0,a.jsxs)("div",{className:" rounded-xl p-4 shadow border bg-green-50 border-green-200 text-green-900 dark:bg-green-500/10 dark:border-green-700 dark:text-green-200 ",children:[(0,a.jsx)("div",{className:"text-sm opacity-90",children:"Pagamentos confirmados"}),(0,a.jsx)("div",{className:"mt-1 text-2xl font-bold",children:i(null!=(v=$.receita)?v:0)}),(0,a.jsxs)("div",{className:"text-xs opacity-80",children:[null!=(j=null==(l=$.pagamentos)?void 0:l.pagos)?j:0," pagos • ",null!=(w=null==(n=$.pagamentos)?void 0:n.pendentes)?w:0," pend. • ",null!=(N=null==(s=$.pagamentos)?void 0:s.expirados)?N:0," exp."]})]}),(0,a.jsxs)("div",{className:" rounded-xl p-4 shadow border bg-blue-50 border-blue-200 text-blue-900 dark:bg-blue-500/10 dark:border-blue-700 dark:text-blue-200 ",children:[(0,a.jsx)("div",{className:"text-sm opacity-90",children:"Opera\xe7\xe3o"}),(0,a.jsxs)("div",{className:"mt-1 text-2xl font-bold",children:[null!=(S=null==E||null==(u=E.inventario)?void 0:u.frotas)?S:0," frotas / ",null!=(k=null==E||null==(c=E.inventario)?void 0:c.dispositivos)?k:0," disp."]}),(0,a.jsxs)("div",{className:"text-xs opacity-80",children:[null!=(_=null==E||null==(x=E.operacao)?void 0:x.operadores)?_:0," oper. • ",null!=(P=null==E||null==(p=E.operacao)?void 0:p.sessoesAtivas)?P:0," sess\xf5es ativas"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"rounded-xl p-4 shadow bg-white dark:bg-[#111827]",children:[(0,a.jsx)("div",{className:"text-sm font-medium mb-2",style:{color:B},children:"Vendas por dia"}),A?(0,a.jsx)("div",{className:"h-[320px] animate-pulse bg-gray-200/50 dark:bg-white/5 rounded-lg"}):(0,a.jsx)(o,{option:Q,height:320})]}),(0,a.jsxs)("div",{className:"rounded-xl p-4 shadow bg-white dark:bg-[#111827]",children:[(0,a.jsx)("div",{className:"text-sm font-medium mb-2",style:{color:B},children:"Pagamentos confirmados por dia"}),A?(0,a.jsx)("div",{className:"h-[320px] animate-pulse bg-gray-200/50 dark:bg-white/5 rounded-lg"}):(0,a.jsx)(o,{option:Y,height:320})]}),(0,a.jsxs)("div",{className:"lg:col-span-2 rounded-xl p-4 shadow bg-white dark:bg-[#111827]",children:[(0,a.jsx)("div",{className:"text-sm font-medium mb-2",style:{color:B},children:"Faturamento por Frota"}),A?(0,a.jsx)("div",{className:"h-[380px] animate-pulse bg-gray-200/50 dark:bg-white/5 rounded-lg"}):(0,a.jsx)(o,{option:Z,height:380})]})]})]})}},1150:(e,t,l)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i}});let a=l(5155),r=l(2115),n=l(4437);function s(e){return{default:e&&"default"in e?e.default:e}}l(6552);let o={loader:()=>Promise.resolve(s(()=>null)),loading:null,ssr:!0},i=function(e){let t={...o,...e},l=(0,r.lazy)(()=>t.loader().then(s)),i=t.loading;function d(e){let s=i?(0,a.jsx)(i,{isLoading:!0,pastDelay:!0,error:null}):null,o=!t.ssr||!!t.loading,d=o?r.Suspense:r.Fragment,u=t.ssr?(0,a.jsxs)(a.Fragment,{children:[null,(0,a.jsx)(l,{...e})]}):(0,a.jsx)(n.BailoutToCSR,{reason:"next/dynamic",children:(0,a.jsx)(l,{...e})});return(0,a.jsx)(d,{...o?{fallback:s}:{},children:u})}return d.displayName="LoadableComponent",d}},3092:(e,t,l)=>{Promise.resolve().then(l.bind(l,166))},4054:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var l in t)Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}(t,{bindSnapshot:function(){return s},createAsyncLocalStorage:function(){return n},createSnapshot:function(){return o}});let l=Object.defineProperty(Error("Invariant: AsyncLocalStorage accessed in runtime where it is not available"),"__NEXT_ERROR_CODE",{value:"E504",enumerable:!1,configurable:!0});class a{disable(){throw l}getStore(){}run(){throw l}exit(){throw l}enterWith(){throw l}static bind(e){return e}}let r="undefined"!=typeof globalThis&&globalThis.AsyncLocalStorage;function n(){return r?new r:new a}function s(e){return r?r.bind(e):a.bind(e)}function o(){return r?r.snapshot():function(e,...t){return e(...t)}}},4437:(e,t,l)=>{"use strict";function a(e){let{reason:t,children:l}=e;return l}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return a}}),l(4553)},6278:(e,t,l)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r}});let a=l(8140)._(l(1150));function r(e,t){var l;let r={};"function"==typeof e&&(r.loader=e);let n={...r,...t};return(0,a.default)({...n,modules:null==(l=n.loadableGenerated)?void 0:l.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},6552:(e,t,l)=>{"use strict";function a(e){let{moduleIds:t}=e;return null}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return a}}),l(5155),l(7650),l(8567),l(7278)},7828:(e,t,l)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorageInstance",{enumerable:!0,get:function(){return a}});let a=(0,l(4054).createAsyncLocalStorage)()},8567:(e,t,l)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorage",{enumerable:!0,get:function(){return a.workAsyncStorageInstance}});let a=l(7828)}},e=>{e.O(0,[8441,1255,7358],()=>e(e.s=3092)),_N_E=e.O()}]);