(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8484],{4871:(l,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>n});var e=t(5155),a=t(2115);function n(){let[l,r]=(0,a.useState)([]),[t,n]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{!async function(){try{let l=await fetch("/api/frotas");if(!l.ok)throw Error("HTTP ".concat(l.status));let t=await l.json();r(Array.isArray(t)?t:[])}catch(l){console.error("Erro ao buscar frotas:",l),r([])}finally{n(!1)}}()},[]),(0,a.useEffect)(()=>{if(0===l.length)return;let t=async()=>{try{let t=await Promise.all(l.map(async l=>{if(!(null==l?void 0:l.id))return l;try{var r,t;let e=await fetch("/api/frotas/".concat(l.id,"/status"));if(!e.ok)throw Error();let a=await e.json();return{...l,pingMs:null!=(r=null==a?void 0:a.rttMs)?r:null,perdaPct:null!=(t=null==a?void 0:a.perdaPct)?t:null,status:(null==a?void 0:a.pingOk)?"online":"offline"}}catch(r){return{...l,status:"offline",pingMs:null,perdaPct:null}}}));r(t)}catch(l){console.warn("Falha ao atualizar status:",l)}};t();let e=setInterval(t,15e3);return()=>clearInterval(e)},[l.length]),(0,e.jsxs)("div",{className:"p-6 md:p-8 bg-[#F0F6FA] dark:bg-[#1a2233] min-h-screen transition-colors",children:[(0,e.jsx)("h1",{className:"text-3xl font-bold mb-6 text-gray-800 dark:text-white",children:"Monitoramento de Frotas"}),t?(0,e.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"Carregando frotas..."}):(0,e.jsx)("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4",children:(null!=l?l:[]).map(l=>{var r,t,a,n,s,o,i;let c=(null==l?void 0:l.valorTotal)!=null?Number(l.valorTotal):Number(null!=(r=null==l?void 0:l.valorTotalCentavos)?r:0)/100,d=Number(null!=(t=null==l?void 0:l.acessos)?t:0),u=["online","on","ok","up","ativo","connected"].includes(String(null!=(i=null==l?void 0:l.status)?i:"").toLowerCase()),g=null!=(a=null==l?void 0:l.pingMs)?a:null,m=null!=(n=null==l?void 0:l.perdaPct)?n:null;return(0,e.jsxs)("div",{className:"bg-white dark:bg-[#232e47] shadow-md rounded-xl p-4 border border-gray-200 dark:border-gray-700 transition-colors",children:[(0,e.jsx)("h2",{className:"text-xl font-semibold mb-3 text-gray-800 dark:text-white",children:null!=(s=null==l?void 0:l.nome)?s:"Sem nome"}),(0,e.jsxs)("p",{className:"text-gray-700 dark:text-gray-200",children:[(0,e.jsx)("strong",{children:"Vendas:"})," ",Number(null!=c?c:0).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})]}),(0,e.jsxs)("p",{className:"text-gray-700 dark:text-gray-200",children:[(0,e.jsx)("strong",{children:"Acessos:"})," ",d," dispositivos"]}),(0,e.jsxs)("div",{className:"mt-2 text-gray-700 dark:text-gray-200",children:[(0,e.jsx)("strong",{children:"Status Mikrotik:"})," ",(0,e.jsx)("span",{className:"inline-block w-3 h-3 rounded-full mr-2 ".concat(u?"bg-green-500":"bg-red-500")}),u?"online":"offline"]}),null!==g&&(0,e.jsxs)("p",{className:"text-gray-600 dark:text-gray-300 text-sm mt-1",children:[(0,e.jsx)("strong",{children:"Lat\xeancia:"})," ",g," ms",null!==m&&" â€¢ Perda: ".concat(m,"%")]})]},null!=(o=null==l?void 0:l.id)?o:null==l?void 0:l.nome)})})]})}},8167:(l,r,t)=>{Promise.resolve().then(t.bind(t,4871))}},l=>{l.O(0,[8441,1255,7358],()=>l(l.s=8167)),_N_E=l.O()}]);